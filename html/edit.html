<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>editor demo</title>

    <link href="../css/edit/editor.css" rel="stylesheet" type="text/css"/>
    <link href="../css/edit/editor-box.css" rel="stylesheet" type="text/css">
    <link href="../wangEditor/release/wangEditor.min.css" rel="stylesheet" type="text/css">
    <link href="../wangEditor/wangEditor-fullscreen-plugin.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
    <!--引入wangEditor中的js-->
    <script type="text/javascript" src="../wangEditor/release/wangEditor.min.js"></script>
    <script type="text/javascript" src="../wangEditor/wangEditor-fullscreen-plugin.js"></script>
    <script type="text/javascript" src="../js/edit/dates.js"></script>
    <script type="text/javascript" src="../js/edit/edit.js"></script>
</head>
<body>
<div class="main-box">
    <!--选择器-->
    <div class="editor-selector" id="tab">
        <ul>
            <li class="editor-li-show">视频制作</li>
            <li>爆料制作</li>
            <li>图文制作</li>
        </ul>
    </div>
    <!--编辑框-->
    <div class="editing-box" id="showBox">
        <!--视频制作-->
        <!--编辑区1-->
        <div class="divbox-header">
            <textarea placeholder="请在这里输入标题" class="articlebox" id="title" required></textarea>
            <textarea placeholder="请输入作者" class="authorbox" id="author" required></textarea>
        </div>
        <!--编辑区2-->
        <div class="divbox-main">
            <!-- 视频制作-->
            <form class="editing">
                <!--菜单栏-->
                <div id="div1-1" class="toolbar"></div>
                <!--编辑区3-->
                <div class="divbox">
                    <div id="div1-2" class="contentbox">
                        <p>从这里开始正文</p>
                    </div>
                </div>
            </form>
            <!-- 视频制作-->

            <!-- 爆料制作-->
            <form class="editing">
                <!--菜单栏-->
                <div id="div2-1" class="toolbar"></div>
                <!--编辑区3-->
                <div class="divbox">
                    <div id="div2-2" class="contentbox">
                        <p>欢迎使用 <b>wangEditor</b> 富文本编辑器</p>
                    </div>
                </div>
            </form>
            <!--爆料制作-->

            <!--图文制作-->
            <form class="editing">
                <!--菜单栏-->
                <div id="div3-1" class="toolbar"></div>
                <!--编辑区3-->
                <div class="divbox">
                    <div id="div3-2" class="contentbox">
                        <p>欢迎使用富文本编辑器</p>
                    </div>
                </div>
            </form>
            <!--图文制作-->
        </div>
        <!--按钮区-->
    </div>
    <div class="editor-send">
        <div class="divbox_level">
            <span>文章等级</span>
            <select id="level">
                <option value="0">1.普通</option>
                <option value="1">2.专业</option>
                <option value="2">3.特级</option>
            </select>
        </div>
        <div class="divbox_button">
            <button class="editing-button" id="save">保存</button>
            <button class="editing-button" id="watch">预览</button>
            <button class="editing-button" id="publish">发布</button>
        </div>
    </div>
</div>


<!--引用js-->
<script type="text/javascript">
    /*选项卡切换*/
    window.onload = function () {
        var nav = document.getElementById('tab');
        var oNav = nav.getElementsByTagName('li');
        var container = document.getElementById('showBox');
        var oDiv = container.getElementsByClassName('editing');
        for (var i = 0; i < oNav.length; i++) {
            oNav[i].index = i;
            oNav[i].onclick = function () {
                for (var i = 0; i < oNav.length; i++) {
                    oNav[i].className = 'editor-li-off';
                    oDiv[i].style.display = "none";
                }
                this.className = 'editor-li-show';
                oDiv[this.index].style.display = "block"
            }
            for (var m = 1; m < oNav.length; m++) {
                oNav[m].className = 'editor-li-off';
                oDiv[m].style.display = "none";
            }
        }
    };
    /*编辑器设计*/
    /*视频编辑器设计*/
    var one_E = window.wangEditor;
    /* 创建富文本编辑器*/
    var one_editor = new one_E('#div1-1', '#div1-2');
    /*div1是菜单栏 div4 是被编辑栏*/
    /*配置菜单栏*/
    one_editor.customConfig.menus = [
        'video',  // 插入视频
    ]
    one_editor.create();
    /*视频编辑器设计*/


    /*爆料编辑器设计*/
    var two_E = window.wangEditor;
    /* 创建富文本编辑器*/
    var two_editor = new two_E('#div2-1', '#div2-2');
    /*div1是菜单栏 div4 是被编辑栏*/
    /*配置菜单栏*/
    two_editor.customConfig.menus = [
        'image',  // 插入图片
        'video',  // 插入视频
    ]
    /*two_editor.customConfig.uploadImgServer = '/admin.php/Upload/wang_editor';  // 上传图片到服务器*/
    two_editor.customConfig.pasteIgnoreImg = true;
    /*忽略粘贴内容的照片*/
    two_editor.customConfig.uploadImgShowBase64 = true;   // 使用 base64 保存图片
    two_editor.customConfig.uploadImgMaxSize = 3 * 1024 * 1024;  //配置上传图片的大小 3M
    two_editor.customConfig.uploadImgMaxLength = 5;   //一次最多上传5张图片
    two_editor.create();

    two_editor.customConfig.uploadImgHooks = {
        before: function (xhr, two_editor, files) {
            // 图片上传之前触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，files 是选择的图片文件
            // 如果返回的结果是 {prevent: true, msg: 'xxxx'} 则表示用户放弃上传
            // return {
            //     prevent: true,
            //     msg: '放弃上传'
            // }
            // alert("前奏");
        },
        success: function (xhr, two_editor, result) {
            // 图片上传并返回结果，图片插入成功之后触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，result 是服务器端返回的结果
            // var url = result.data.url;
            // alert(JSON.stringify(url));
            // editor.txt.append(url);
            // alert("成功");
        },
        fail: function (xhr, two_editor, result) {
            // 图片上传并返回结果，但图片插入错误时触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，result 是服务器端返回的结果
            alert("失败");
        },
        error: function (xhr, two_editor) {
            // 图片上传出错时触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象
            // alert("错误");
        },
        // 如果服务器端返回的不是 {errno:0, data: [...]} 这种格式，可使用该配置
        // （但是，服务器端返回的必须是一个 JSON 格式字符串！！！否则会报错）
        customInsert: function (insertImg, result, two_editor) {
            // 图片上传并返回结果，自定义插入图片的事件（而不是编辑器自动插入图片！！！）
            // insertImg 是插入图片的函数，editor 是编辑器对象，result 是服务器端返回的结果
            // 举例：假如上传图片成功后，服务器端返回的是 {url:'....'} 这种格式，即可这样插入图片：
            var url2 = result.data[0];
            insertImg(url);
            console.log("插入图片 url = " + url2);
            // result 必须是一个 JSON 格式字符串！！！否则报错
        }
    }
    /*爆料编辑器设计*/

    /*图文制作编辑器设计*/
    var three_E = window.wangEditor;
    /* 创建富文本编辑器*/
    var three_editor = new three_E('#div3-1', '#div3-2');
    /*div1是菜单栏 div4 是被编辑栏*/
    /*配置菜单栏*/
    three_editor.customConfig.menus = [
        'head',  // 标题
        'bold',  // 粗体
        'fontSize',  // 字号
        'fontName',  // 字体
        'italic',  // 斜体
        'underline',  // 下划线
        'strikeThrough',  // 删除线
        'foreColor',  // 文字颜色
        'backColor',  // 背景颜色
        'link',  // 插入链接
        'list',  // 列表
        'justify',  // 对齐方式
        'quote',  // 引用
        'emoticon',  // 表情
        'image',  // 插入图片
        'table',  // 表格
        'video',  // 插入视频
        'code',  // 插入代码
        'undo',  // 撤销
        'redo'  // 重复
    ]
    three_editor.customConfig.debug = true;
    three_editor.customConfig.pasteIgnoreImg = true;
    /*忽略粘贴内容的照片*/
    three_editor.customConfig.uploadImgShowBase64 = true;   // 使用 base64 保存图片
    three_editor.customConfig.uploadImgMaxSize = 3 * 1024 * 1024;       // 3M
    three_editor.customConfig.uploadImgMaxLength = 5;  // 限制一次最多上传 5 张图片
    /*three_editor.customConfig.uploadFileName = '0_img';*/          // 自定义文件名
    three_editor.customConfig.uploadImgTimeout = 5000;// 将 timeout 时间改为 3s
    three_editor.create();

    three_editor.customConfig.uploadImgHooks = {
        before: function (xhr, three_editor, files) {               // 图片上传之前触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，files 是选择的图片文件
            // 如果返回的结果是 {prevent: true, msg: 'xxxx'} 则表示用户放弃上传
            // return {
            //     prevent: true,
            //     msg: '放弃上传'
            // }
            // alert("前奏");
        },
        success: function (xhr, three_editor, result) {
            // 图片上传并返回结果，图片插入成功之后触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，result 是服务器端返回的结果
            // var url = result.data.url;
            // alert(JSON.stringify(url));
            // editor.txt.append(url);
            // alert("成功");
        },
        fail: function (xhr, three_editor, result) {
            // 图片上传并返回结果，但图片插入错误时触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象，result 是服务器端返回的结果
            // alert("失败");
        },
        error: function (xhr, three_editor) {
            // 图片上传出错时触发
            // xhr 是 XMLHttpRequst 对象，editor 是编辑器对象
            // alert("错误");
        },
        // 如果服务器端返回的不是 {errno:0, data: [...]} 这种格式，可使用该配置
        // （但是，服务器端返回的必须是一个 JSON 格式字符串！！！否则会报错）
        customInsert: function (insertImg, result, three_editor) {
            // 图片上传并返回结果，自定义插入图片的事件（而不是编辑器自动插入图片！！！）
            // insertImg 是插入图片的函数，editor 是编辑器对象，result 是服务器端返回的结果
            // 举例：假如上传图片成功后，服务器端返回的是 {url:'....'} 这种格式，即可这样插入图片：
            var url = result.data[0];
            insertImg(url);
            // result 必须是一个 JSON 格式字符串！！！否则报错
        }
    }

    /*提交数据*/
    document.getElementById('save').addEventListener('click', function () {
        // 读取 html
        var content;
        switch (e) {
            case 1:
                one_editor.txt.html(content);
                content = one_editor.txt.html();
                break;
            case 2:
                two_editor.txt.html(content);
                content = two_editor.txt.html();
                break;
            case 3:
                three_editor.txt.html(content);
                content = three_editor.txt.html();
        }
        var sop = document.getElementById("level");
        var level = sop.selectedIndex;
        alert(content);
        $.ajax({
            url: "http://223.3.65.243:9095/article/articles?msg=" + content,
            type: "post",
            dataType: "json",
            authorId: "001",
            title: level,
            success: function (data) {
                alert(data.result);
            },
            error: function (content) {
                alert("ajax连接异常：" + content);
            }
        });
    }, false)
</script>

</body>
</html>